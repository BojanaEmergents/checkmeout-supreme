var t0=performance.now();var url_split=window.location.href.split("/");var report=new Object;report.timestamp=Date.now();report.version=chrome.runtime.getManifest().version;report.out=[];report.err=[];function log(message,type){if(type=="out"){report.out.push(message)}else if(type=="err"){report.err.push(message)}else{console.log("Invalid message type.")}chrome.storage.sync.set({report:report},null)}function match(name,guesses){guesses=guesses.split(" ");for(guess in guesses){if(name.toLowerCase().indexOf(guesses[guess].toLowerCase())!=-1){return true}}}function asyncNotify(title,message){$.notify({title:"<b>"+title+"</b><br>",message:message},{newest_on_top:true,allow_dismiss:false,placement:{from:"top",align:"left"},delay:1e3})}function findKeywordItem(current_item){chrome.storage.sync.get({region:"",runnable:"",kw_enabled:"",ar_enabled:"",category:"",keywords:"",colour:"",queue:""},function(items){if(!current_item){log("Empty shopping list","err");alert("No items in your shopping list!")}log("SEARCHING: "+current_item,"out");xhr=new XMLHttpRequest;if(current_item[0]=="jackets"){xhr.open("GET","http://www.supremenewyork.com/shop/all/jackets",false)}else if(current_item[0]=="shirts"){xhr.open("GET","http://www.supremenewyork.com/shop/all/shirts",false)}else if(current_item[0]=="tops_sweaters"){xhr.open("GET","http://www.supremenewyork.com/shop/all/tops_sweaters",false)}else if(current_item[0]=="sweatshirts"){xhr.open("GET","http://www.supremenewyork.com/shop/all/sweatshirts",false)}else if(current_item[0]=="pants"){xhr.open("GET","http://www.supremenewyork.com/shop/all/pants",false)}else if(current_item[0]=="shorts"){xhr.open("GET","http://www.supremenewyork.com/shop/all/shorts",false)}else if(current_item[0]=="t-shirts"){xhr.open("GET","http://www.supremenewyork.com/shop/all/t-shirts",false)}else if(current_item[0]=="hats"){xhr.open("GET","http://www.supremenewyork.com/shop/all/hats",false)}else if(current_item[0]=="bags"){xhr.open("GET","http://www.supremenewyork.com/shop/all/bags",false)}else if(current_item[0]=="accessories"){xhr.open("GET","http://www.supremenewyork.com/shop/all/accessories",false)}else if(current_item[0]=="skate"){xhr.open("GET","http://www.supremenewyork.com/shop/all/skate",false)}else if(current_item[0]=="shoes"){xhr.open("GET","http://www.supremenewyork.com/shop/all/shoes",false)}xhr.send();parser=new DOMParser;htmlDoc=parser.parseFromString(xhr.responseText,"text/html");articles=htmlDoc.getElementsByTagName("article");var notfound_item=0;var found_items=0;var notfound_colour=0;for(var i=0;i<articles.length;i++){var name=articles[i].childNodes[0].childNodes[1].childNodes[0].text;var color=articles[i].childNodes[0].childNodes[2].childNodes[0].text;if(name.toLowerCase().indexOf(current_item[1].toLowerCase())!=-1){found_items+=1;if(match(color,current_item[2])){var href=articles[i].childNodes[0].childNodes[0].getAttribute("href");window.location.href="http://www.supremenewyork.com"+href}else{notfound_colour+=1}}else{notfound_item+=1}}if(notfound_item==articles.length){log("No product found: "+current_item[1]+" in: "+current_item[0],"err");if(!items.ar_enabled){asyncNotify("Check Me Out","No matching products found. Check your keywords!")}else{chance=Math.floor(Math.random()*10+1);if(chance==1){asyncNotify("Check Me Out","No matching products found. Check your keywords!")}}}if(notfound_colour==found_items){log("No colour found: "+current_item[2]+" item: "+current_item[1],"err");if(!items.ar_enabled){asyncNotify("Check Me Out","No matching colours found. Check your keywords!")}else{chance=Math.floor(Math.random()*10+1);if(chance==1){asyncNotify("Check Me Out","No matching colours found. Check your keywords!")}}}})}if(url_split[url_split.length-1]=="shop"||url_split[url_split.length-3]=="shop"){log("Ran on shop page","out");chrome.storage.sync.get({region:"",runnable:"",kw_enabled:"",queue:""},function(items){if(items.kw_enabled&&items.runnable&&items.region!="jp"){findKeywordItem(items.queue[0])}})}if(window.location.href.includes("shop/")&&/^([a-zA-Z0-9]{9})$/.test(url_split[url_split.length-1])){log("Ran on item page","out");chrome.storage.sync.get({region:"",kw_enabled:"",alt_size:"",queue:"",any_size:""},function(items){if(items.region!="jp"&&items.kw_enabled){var size=items.queue[0][3];var values=$.map($("#size option"),function(option){return option.text});if(values.indexOf(items.queue[0][3])==-1&&items.any_size==false&&items.queue[0][3]!="One size"){log("Size not found","err");alert("Size "+items.queue[0][3]+" not available. The bot will now halt.")}else{setInterval(function(){if(!$(".in-cart").is(":visible")){$("#size option").each(function(i){if($(this).text()==size){$("#size").prop("selectedIndex",i)}})}},5);log("Added item to cart","out");setInterval(function(){$("#add-remove-buttons").children("input:not(.remove)").click()},10)}var remaining=items.queue;remaining.splice(0,1);chrome.storage.sync.set({queue:remaining},null);var t=setInterval(function(){if($("#container").hasClass("has-cart")){if(items.queue[0]!=undefined){findKeywordItem(items.queue[0])}else{log("Navigated to checkout","out");setTimeout(function(){window.location.href="https://www.supremenewyork.com/checkout"},50)}clearInterval(t)}},10)}else{var values=$.map($("#size option"),function(option){return option.text});if(values.indexOf(items.alt_size)==-1&&items.any_size==false&&items.alt_size!="One size"){log("Size not found","err");alert("Size "+items.alt_size+" not available. The bot will now halt.")}else{setInterval(function(){if(!$(".in-cart").is(":visible")){$("#size option").each(function(i){if($(this).text()==items.alt_size){$("#size").prop("selectedIndex",i)}})}},5);log("Added item to cart","out");setInterval(function(){$("#add-remove-buttons").children("input:not(.remove)").click()},10)}var t=setInterval(function(){if($("#container").hasClass("has-cart")){log("Navigated to checkout","out");setTimeout(function(){window.location.href="https://www.supremenewyork.com/checkout"},50);clearInterval(t)}},10)}})}if(window.location.href.includes("checkout")){log("Ran on checkout page","out");chrome.storage.sync.get({region:"",runnable:"",name:"",email:"",phone:"",address:"",address2:"",address3:"",city:"",zip:"",state:"",prefecture:"",country:"",card_type:"",card_no:"",expiry_month:"",expiry_year:"",cvv:"",autoco:"",tryagain:"",bypass:"",delay:""},function(items){if(items.bypass){var _0xbd9e=["remove",".g-recaptcha"];$(_0xbd9e[1])[_0xbd9e[0]]()}$("label").each(function(i){if($(this).text()=="full name"||$(this).text()=="name"){document.getElementById($(this).attr("for")).value=items.name}if($(this).text()=="名前"){var a=$(this).attr("for");var b=document.getElementById(a).parentNode;b.childNodes[1].value=items.name.split(" ")[0];b.childNodes[2].value=items.name.split(" ")[1]}if($(this).text()=="email"||$(this).text()=="Eメール"){document.getElementById($(this).attr("for")).value=items.email}if($(this).text()=="tel"||$(this).text()=="電話番号"){document.getElementById($(this).attr("for")).value=items.phone}if($(this).text()=="address"||$(this).text()=="住所"){document.getElementById($(this).attr("for")).value=items.address}if($(this).text()=="city"||$(this).text()=="区市町村"){document.getElementById($(this).attr("for")).value=items.city}if($(this).text()=="postcode"||$(this).text()=="zip"||$(this).text()=="郵便番号"){document.getElementById($(this).attr("for")).value=items.zip}if($(this).text()=="state"){document.getElementById($(this).attr("for")).value=items.state}if($(this).text()=="都道府県"){document.getElementById($(this).attr("for")).value=items.prefecture}if($(this).text()=="country"){document.getElementById($(this).attr("for")).value=items.country}if($(this).text()=="type"||$(this).text()=="支払い方法"){document.getElementById($(this).attr("for")).value=items.card_type}if($(this).text()=="exp. date"||$(this).text()=="有効期限"){var a=$(this).attr("for");var b=document.getElementById(a).parentNode;b.childNodes[1].value=items.expiry_month;b.childNodes[2].value=items.expiry_year}});$("div").each(function(i){if($(this).text()=="number"||$(this).text()=="カード番号"){var a=$(this).attr("for");if(a!=undefined){document.getElementById(a).value=items.card_no}}if($(this).text()=="CVV"||$(this).text()=="CVV番号"){var a=$(this).attr("for");if(a!=undefined){document.getElementById(a).value=items.cvv}}});if(document.getElementById("oba3")!=null){document.getElementById("oba3").value=items.address2}if(document.getElementById("order_billing_address_3")!=null){document.getElementById("order_billing_address_3").value=items.address3}document.getElementsByName("order[terms]")[1].parentElement.className="icheckbox_minimal checked";document.getElementsByName("order[terms]")[0].checked=true;document.getElementsByName("order[terms]")[1].checked=true;if(items.autoco&&items.runnable){log("Checked out","out");setTimeout(function(){document.getElementsByName("commit")[0].click()},items.delay*1e3);if(!items.tryagain){chrome.storage.sync.set({runnable:false},null)}}})}console.log((performance.now()-t0).toFixed(2)+" ms");